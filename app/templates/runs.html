{% extends "base.html" %} {% block title %}Job Runs - LineageForge{% endblock %}
{% block content %}
<div class="runs-page">
    <h1>Job Run History</h1>

    <table class="runs-table">
        <thead>
            <tr>
                <th>Run ID</th>
                <th>Job Type</th>
                <th>Status</th>
                <th>Created</th>
                <th>Started</th>
                <th>Completed</th>
                <th>Duration</th>
                <th>Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for run in runs %}
            <tr>
                <td><code>{{ run.run_id }}</code></td>
                <td>{{ run.job_type.value }}</td>
                <td>
                    <span class="status-{{ run.status.value }}"
                        >{{ run.status.value }}</span
                    >
                </td>
                <td>{{ run.created_at.strftime('%Y-%m-%d %H:%M:%S') }}</td>
                <td>
                    {{ run.started_at.strftime('%Y-%m-%d %H:%M:%S') if
                    run.started_at else '-' }}
                </td>
                <td>
                    {{ run.completed_at.strftime('%Y-%m-%d %H:%M:%S') if
                    run.completed_at else '-' }}
                </td>
                <td>
                    {% if run.started_at and run.completed_at %} {{
                    ((run.completed_at - run.started_at).total_seconds())|int
                    }}s {% else %} - {% endif %}
                </td>
                <td>
                    <button
                        hx-delete="/api/jobs/{{ run.run_id }}"
                        hx-confirm="Delete this job?"
                        hx-target="closest tr"
                        hx-swap="outerHTML swap:0s"
                        class="btn-delete"
                    >
                        Delete
                    </button>
                </td>
            </tr>
            {% if run.result_summary %}
            <tr class="run-details">
                <td colspan="7">
                    <strong>Results:</strong>
                    <pre>{{ run.result_summary }}</pre>
                </td>
            </tr>
            {% endif %} {% if run.error_message %}
            <tr class="run-details error">
                <td colspan="7">
                    <strong>Error:</strong> {{ run.error_message }}
                </td>
            </tr>
            {% endif %} {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
